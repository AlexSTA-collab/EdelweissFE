*material, name=UntereggerRockMassNonLocal, id=urmnl, statevars=5, 
** units in N and mm
** ,  E             nu          fcu         m0            e       mg1          fcy         Ah         
   56665e+03,     0.2040,  	41.60e+03,    	11.95,  	0.51,   9.943,   	29.53e+03,  0.004467   
**   Bh          Ch          Dh      Gh      As     Bs           GSI   D 
  1e-05,     8.817,  	 1e-6,    	0,  	15,     2.0,        40,   0
** omegaMax, nonlocalRadius nonlocalweight    epsilonF   
        0.99,   0.02,             1.005,          1.e-6,      
    **0.99,   0.02,             1.005,          1.36798e-3,      

*job, name=cps4nonlocaljob, domain=2d, solver=NISTParallel

*modelGenerator, generator=planeRectQuad, name=gen
x0=0, l=0.15
y0=0, h=1.5
elType=uelCPS4NonLocal
nX=1
nY=10

*elSet, elSet=weak
5

*section, name=sectionAll, thickness=1.00, material=urmnl, type=planeUelUmat
all
*section, name=sectionWeak, thickness=0.95, material=urmnl, type=planeUelUmat
weak

*fieldOutput
name=Displacement, nSet=all, field=displacement, result=U, 
**name=NonlocalDmg, elSet=all, field=nonlocal damage, result=U, 
name=Stress, elSet=all, result=stress, gaussPt=1
name=Strain, elSet=all, result=strain, gaussPt=1
name=AlphaP, elSet=all, result=sdv, gaussPt=1, index=0, 
name=AlphaD, elSet=all, result=sdv, gaussPt=1, index=2, 
name=Omega,  elSet=all, result=sdv, gaussPt=1, index=4, 
name=Displacement_Top, nSet=gen_top, field=displacement, result=U
name=Force_Bottom, nSet=gen_bottom, field=displacement, result=P
name=meanDispLoad, nSet=gen_top, field=displacement, result=U, f(x)='mean(x[:,1])', saveHistory=True
name=sumRFNodes, nSet=gen_top, field=displacement, result=P, f(x)='sum(x[:,1])', saveHistory=True

****output, type=monitor, jobName=cps4nonlocaljob, name=myNodeSetMonitor
***fieldOutput=Displacement_Top, f(x)='mean(x[:,1])',export=RF_10elnl_GSI40 
***fieldOutput=Force_Bottom, f(x)='sum(x[:,1])', export=u_elnl_GSI40
*output, type=meshPlot, jobName=cps4nonlocaljob 
figure=1, axSpec=221, create=perNode, fieldOutput=Displacement,  label=uy, f(x)='x[:,1]'
**figure=1, axSpec=224, create=perNode, fieldOutput=NonlocalDmg, label=alphaDNL
figure=1, axSpec=224, create=perElement, fieldOutput=AlphaP, label=alphaP
figure=1, axSpec=223, c=red, ls=dashed, create=xyData, x=meanDispLoad, y=sumRFNodes,
figure=1, axSpec=222, create=perElement, fieldOutput=Omega, label=omega
configFigure, figure=1, axSpec=223, xLabel=u (m), yLabel=RF (kN) 

*step, jobName=cps4nonlocaljob, maxInc=1e-2, minInc=1e-8, maxNumInc=10000, maxIter=20, stepLength=1
options, category=NISTSolver, numThreads=15
dirichlet, name=bottom, nSet=gen_bottom,  field=displacement, 2=0
dirichlet, name=bottomLeft, nSet=gen_leftBottom,  field=displacement, 1=0
dirichlet, name=top, nSet=gen_top, field=displacement, 2=0.0004


*parameterIdentification, id=urmnl, jobName=cps4nonlocaljob, xData=u_1el_GSI40.csv, yData=RF_1el_GSI40.csv, plot=True, file=identifiedParameters.inp
idx=19, start=0.001, min=0.000001, max=0.01   
type=y, result=P, nSet=gen_top, field=displacement, direction=2, f(x)=sum(x) 
type=x, result=U, nSet=gen_top, field=displacement, direction=2, f(x)=mean(x)
**type=x, result=time
**type=y, node=22, result=U, field=displacement, direction=1 
**type=z, nSet=gen_top, result=U, field=displacement, direction=1,  f(x)=mean(x)   
**type=u, element=1, result=stress, index=0,  f(x)=-x*1000   
**type=v, elSet=gen_top, result=sdv, index=4,  f(x)=mean(x)   
**type=v, element=5, result=sdv, index=4,  f(x)=mean(x)   
