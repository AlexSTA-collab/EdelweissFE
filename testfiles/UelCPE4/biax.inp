*material, name=UntereggerRockMass, id=untereggerRockMass, statevars=31, 
** units in N and mm
**  E  nu          fcu         m0            e       mg1         fcy             
 31282,     0.11,  	142.7,    	13.24,  	0.51,   9.16,   		90,    0.15
** GFI   Ah          Bh          Ch          Dh      Gh      As     Bs   GSI 
  0.00967,    1e-05,     0.8,  	 1e-6,    	0,  	40.38,	2.26,     100,
**D  omegaMax,       
 0,         0.99,      

*elSet, elSet=weak
1200

*material, name=LinearElastic, id=le, statevars=0, 
 31282,     0.11

*section, name=section1, thickness=1.0, material=untereggerRockMass, type=planeUelUmat
all
*section, name=section1, thickness=1.0, material=le, type=planeUelUmat
gen_top
*section, name=section1, thickness=1.0, material=le, type=planeUelUmat
gen_bottom


*job, name=cpe4job, domain=2d, solver=NIST

*modelGenerator, generator=planeRectQuad, name=gen
x0=0, l=30.
y0=0, h=80.
elType=uelCPE4
nX=30
nY=80

*output, type=nodesetmonitor, jobName=cpe4job
nSet=gen_top, field=displacement, result=U, f(x)=mean(x), direction=2
*output, type=nodesetmonitor, jobName=cpe4job
nSet=gen_bottom, field=displacement, result=P, f(x)=sum(x), direction=2

*nSet, nSet=lowerLeft
1

*output, type=ensight, jobName=cpe4job, name=esExport
create=perNode,    elSet=all, field=displacement, result=U, name=displacement
create=perElement, elSet=all, result=stress, gaussPt=1
create=perElement, elSet=all, result=strain, gaussPt=1
create=perElement, elSet=all, result=sdv, gaussPt=1, index=0, name=alphaP
create=perElement, elSet=all, result=sdv, gaussPt=1, index=2, name=alphaD
create=perElement, elSet=all, result=sdv, gaussPt=1, index=4, name=omega

*step, jobName=cpe4job, maxInc=1.0
dirichlet, name=bottom, nSet=gen_bottom,   field=displacement, 2=0.0, 
dirichlet, name=top, nSet=gen_top,   field=displacement, 2=0.0, 
dirichlet, name=lowerLeft, nSet=lowerLeft,   field=displacement, 1=0.0, 
distributedload, name=dlLeft, surface=gen_left, magnitude=50, f(t)=1, type=pressure
distributedload, name=dlRight, surface=gen_right, magnitude=50, f(t)=1, type=pressure
geostatic, name=geo, elSet=all, p1=-50, h1=150, p2=-50, h2=0, xLateral=1.0, zLateral=1.0

*step, jobName=cpe4job, maxInc=1e-1 
options, category=NISTSolver, extrapolation=on, numThreads=15
dirichlet, name=top, field=displacement, nSet=gen_top, 2=-2.0

***output, type=meshPlot, jobName=cpe4job 
**figure=1, axSpec=221, create=perNode, field=displacement, result=U, name=U, f(x)=x[1] 
**figure=1, axSpec=222, create=perElement, result=stress, index=0, name=s11, gaussPt=1
**figure=1, axSpec=223, create=perElement, result=stress, index=0, name=s22, gaussPt=1
**figure=1, axSpec=224, create=perElement, result=stress, index=0, name=s33, gaussPt=1
